<!-- templates/files/shared_file.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shared: {{ file.original_name }}</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; max-width: 600px; margin: 40px auto; padding: 20px; }
        .card { border: 1px solid #e1e5e9; border-radius: 8px; padding: 24px; background: #f8fafc; }
        .header { text-align: center; margin-bottom: 24px; }
        .btn { display: inline-block; background: #3b82f6; color: white; text-decoration: none; padding: 12px 24px; border-radius: 6px; font-weight: 500; }
        .btn:hover { background: #2563eb; }
        .meta { background: #fff; padding: 16px; border-radius: 6px; margin: 16px 0; }
        .warning { background: #fef3c7; border-left: 4px solid #f59e0b; padding: 12px; font-size: 0.875rem; }
    </style>
</head>
<body>
    <div class="card">
        <div class="header">
            <h1>üìÅ {{ file.original_name }}</h1>
            <p>Shared by <strong>{{ link.owner.email }}</strong></p>
        </div>

        <div class="meta">
            <p><strong>Size:</strong> {{ file.size|filesizeformat }}</p>
            <p><strong>Expires:</strong> 
                {% if link.expires_at %}
                    {{ link.expires_at|date:"j M Y, P" }}
                {% else %}
                    <em>After first access (24 hours)</em>
                {% endif %}
            </p>
            <p><strong>Views:</strong> {{ link.view_count }} &nbsp;|&nbsp; 
               <strong>Downloads:</strong> {{ link.download_count }} / {{ link.max_downloads }}</p>
        </div>

        {% if link.download_count < link.max_downloads and not link.is_expired %}
            <p style="text-align:center;">
                <a href="{{ download_url }}" class="btn" download="{{ file.original_name }}">
                    ‚¨áÔ∏è Download File
                </a>
            </p>
        {% else %}
            <div class="warning">
                {% if link.is_expired %}
                    üîí This link has expired.
                {% elif link.download_count >= link.max_downloads %}
                    üö´ Download limit reached ({{ link.max_downloads }}).
                {% endif %}
            </div>
        {% endif %}

        <div class="warning">
            <strong>Note:</strong> This file is end-to-end encrypted. 
            Your browser will decrypt it after download using keys embedded in the file metadata.
        </div>
    </div>
</body>
</html>