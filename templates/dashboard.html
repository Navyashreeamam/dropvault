<!DOCTYPE html>
<html>
<head>
  <title>DropVault - Dashboard</title>
  <meta name="csrf-token" content="{{ csrf_token }}">
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    ul { list-style-type: none; padding: 0; }
    li { padding: 10px 0; border-bottom: 1px solid #eee; }
    button { margin: 3px 2px; padding: 4px 8px; font-size: 12px; cursor: pointer; }
    .file-row { display: flex; align-items: center; gap: 8px; flex-wrap: wrap; }
    .share-group { display: flex; flex-direction: column; gap: 4px; }
    .email-form { display: none; margin-top: 6px; font-size: 12px; background: #f5f5f5; padding: 8px; border-radius: 4px; }
    .email-form input { padding: 4px; font-size: 12px; width: 200px; }
    .email-form textarea { padding: 4px; font-size: 12px; width: 200px; height: 40px; }
    .link-input { display: none; margin-top: 6px; font-size: 11px; width: 280px; padding: 4px; }
    
    /* Tabs styling */
    .tabs { display: flex; gap: 10px; margin: 20px 0; }
    .tab { padding: 8px 16px; background: #f0f0f0; border: none; border-radius: 4px; cursor: pointer; }
    .tab.active { background: #007bff; color: white; }
    
    /* Trash specific styles */
    .trash-container { display: none; margin-top: 20px; }
    .file-item { 
      padding: 12px; 
      border: 1px solid #eee; 
      border-radius: 4px; 
      margin-bottom: 8px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .file-info { flex: 1; }
    .file-name { font-weight: bold; display: block; margin-bottom: 4px; }
    .file-size { color: #666; font-size: 0.9em; margin-right: 10px; }
    .delete-info { color: #888; font-size: 0.85em; display: block; }
    .days-remaining { 
      display: inline-block; 
      font-weight: bold; 
      font-size: 0.85em;
      margin-top: 4px;
      padding: 2px 6px;
      border-radius: 3px;
      background: #e8f5e9;
      color: #2e7d32;
    }
    .days-remaining.warning { 
      background: #ffebee;
      color: #d32f2f; 
    }
    .restore-btn { 
      background: #4caf50;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 4px;
      cursor: pointer;
    }
    .restore-btn:hover {
      background: #388e3c;
    }
    .no-files { color: #888; font-style: italic; padding: 20px; text-align: center; }
    .loading { text-align: center; padding: 20px; color: #666; }
    
    /* Success/Error messages */
    .success-msg { color: #2e7d32; background: #e8f5e9; padding: 8px; border-radius: 4px; margin: 5px 0; }
    .error-msg { color: #d32f2f; background: #ffebee; padding: 8px; border-radius: 4px; margin: 5px 0; }
  </style>
</head>
<body>
<h1>Dashboard - {{ user.email }}</h1>

<!-- Upload Form -->
<form id="uploadForm" enctype="multipart/form-data">
  {% csrf_token %}
  <input type="file" name="file" required>
  <button type="submit">Upload File</button>
</form>

<!-- Tabs Navigation -->
<div class="tabs">
  <button id="files-tab" class="tab active">ğŸ“ Your Files</button>
  <button id="trash-tab" class="tab">ğŸ—‘ï¸ Trash (<span id="trash-count">0</span>)</button>
</div>

<!-- Files Container -->
<div id="files-container">
  <h2>Your Files</h2>
  <ul id="fileList">
    <li>Loading files...</li>
  </ul>
  <button onclick="loadFiles()">ğŸ”„ Refresh Files</button>
</div>

<!-- Trash Container (initially hidden) -->
<div id="trash-container" class="trash-container">
  <h2>ğŸ—‘ï¸ Trash</h2>
  <p style="color: #666; font-size: 0.9em;">Files in trash will be permanently deleted after 30 days.</p>
  <div id="trash-list">
    <p class="loading">Loading trash...</p>
  </div>
</div>

<!-- Shared by You -->
<div style="margin-top: 30px;">
  <h3>ğŸ”— Shared by You ({{ shared_links|length }})</h3>
  {% if shared_links %}
    <ul style="list-style-type: none; padding: 0;">
      {% for link in shared_links %}
        <li style="padding: 8px 0; border-bottom: 1px solid #eee; font-size: 14px;">
          ğŸ“„ <strong>{{ link.file.original_name }}</strong>
          {% if link.slug %}
            <br><small>ğŸ”— Public link: <a href="/s/{{ link.slug }}/" target="_blank">/s/{{ link.slug }}/</a></small>
          {% else %}
            <br><small>ğŸ“§ Email link (token: {{ link.token|truncatechars:12 }})</small>
          {% endif %}
          <br><small>
            ğŸ‘ï¸ Views: {{ link.view_count }} |
            â¬‡ï¸ Downloads: {{ link.download_count }}/{{ link.max_downloads }} |
            {% if link.is_expired %}<span style="color:#d32f2f">âŒ Expired</span>
            {% else %}<span style="color:#2e7d32">âœ… Active</span>
            {% endif %}
          </small>
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <p style="color: #666;">ğŸ•— No shared links yet.</p>
  {% endif %}
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ”§ CSRF TOKEN
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const csrfToken = document.querySelector('meta[name="csrf-token"]').getAttribute('content');

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ“¤ UPLOAD FILE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
document.getElementById('uploadForm').addEventListener('submit', async (e) => {
  e.preventDefault();
  const formData = new FormData(e.target);
  try {
    const res = await fetch('/files/upload/', {
      method: 'POST',
      body: formData,
      headers: { 'X-CSRFToken': csrfToken }
    });
    const data = await res.json();
    if (res.ok) {
      alert('âœ… File uploaded successfully!');
      loadFiles();
      e.target.reset();
    } else {
      alert('âŒ Upload failed: ' + (data.error || 'Unknown error'));
    }
  } catch (err) {
    alert('âŒ Network error: ' + err.message);
  }
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ“‚ LOAD FILES
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function loadFiles() {
  try {
    const res = await fetch('/api/list/', {
      headers: { 'X-CSRFToken': csrfToken }
    });

    if (!res.ok) {
      document.getElementById('fileList').innerHTML = '<li>âŒ Failed to load files</li>';
      return;
    }

    const files = await res.json();
    if (files.length === 0) {
      document.getElementById('fileList').innerHTML = '<li>ğŸ“ No files uploaded yet.</li>';
    } else {
      document.getElementById('fileList').innerHTML = files.map(f => `
        <li>
          <div class="file-row">
            <strong>${escapeHtml(f.original_name || f.filename)}</strong> 
            (${formatFileSize(f.size)})
            <button onclick="deleteFile(${f.id})">ğŸ—‘ï¸ Delete</button>
            <div class="share-group">
              <button onclick="toggleEmailForm(${f.id})">ğŸ“§ Share via Email</button>
              <div id="email-form-${f.id}" class="email-form">
                <div style="margin-bottom: 6px;">
                  <label>Recipient Email:</label><br>
                  <input type="email" id="email-input-${f.id}" placeholder="recipient@example.com" required>
                </div>
                <div style="margin-bottom: 6px;">
                  <label>Message (optional):</label><br>
                  <textarea id="message-input-${f.id}" placeholder="Check out this file..."></textarea>
                </div>
                <button onclick="submitEmailShare(${f.id})">ğŸ“¤ Send</button>
                <button onclick="toggleEmailForm(${f.id})">âœ• Cancel</button>
                <div id="email-status-${f.id}"></div>
              </div>
              <button onclick="copyLink(${f.id})">ğŸ”— Copy Link</button>
              <input type="text" id="link-input-${f.id}" class="link-input" readonly onclick="this.select()">
            </div>
          </div>
        </li>
      `).join('');
    }
  } catch (err) {
    document.getElementById('fileList').innerHTML = `<li>âŒ Error: ${err.message}</li>`;
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ“§ TOGGLE EMAIL FORM
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function toggleEmailForm(fileId) {
  const form = document.getElementById(`email-form-${fileId}`);
  if (form.style.display === 'none' || form.style.display === '') {
    form.style.display = 'block';
  } else {
    form.style.display = 'none';
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ“§ SUBMIT EMAIL SHARE (FIXED!)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function submitEmailShare(fileId) {
  const emailInput = document.getElementById(`email-input-${fileId}`);
  const messageInput = document.getElementById(`message-input-${fileId}`);
  const statusDiv = document.getElementById(`email-status-${fileId}`);
  
  const recipientEmail = emailInput.value.trim();
  const message = messageInput.value.trim();
  
  // Validate email
  if (!recipientEmail) {
    statusDiv.innerHTML = '<p class="error-msg">âŒ Please enter an email address</p>';
    return;
  }
  
  // Simple email validation
  const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
  if (!emailRegex.test(recipientEmail)) {
    statusDiv.innerHTML = '<p class="error-msg">âŒ Please enter a valid email address</p>';
    return;
  }
  
  statusDiv.innerHTML = '<p>â³ Sending...</p>';
  
  try {
    const res = await fetch(`/files/share/${fileId}/email/`, {
      method: 'POST',
      headers: {
        'X-CSRFToken': csrfToken,
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({ 
        recipient_email: recipientEmail,  // âœ… FIXED: Use correct field name
        message: message 
      })
    });

    const data = await res.json();
    console.log('Share response:', data);
    
    if (res.ok) {
      if (data.email_sent) {
        statusDiv.innerHTML = `<p class="success-msg">âœ… Email sent to ${recipientEmail}!</p>`;
      } else {
        statusDiv.innerHTML = `<p class="success-msg">âœ… Link created! ${data.warning || ''}<br>Share URL: <a href="${data.share_url}" target="_blank">${data.share_url}</a></p>`;
      }
      emailInput.value = '';
      messageInput.value = '';
      // Hide form after 3 seconds
      setTimeout(() => {
        toggleEmailForm(fileId);
        statusDiv.innerHTML = '';
      }, 5000);
    } else {
      statusDiv.innerHTML = `<p class="error-msg">âŒ ${data.error || 'Failed to share'}</p>`;
    }
  } catch (err) {
    console.error('Email share error:', err);
    statusDiv.innerHTML = `<p class="error-msg">âŒ Network error: ${err.message}</p>`;
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ”— COPY LINK (FIXED!)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function copyLink(fileId) {
  const btn = event.target;
  const originalText = btn.textContent;
  btn.disabled = true;
  btn.textContent = 'â³ Creating...';

  try {
    const res = await fetch(`/files/share/${fileId}/`, {
      method: 'POST',
      headers: { 
        'X-CSRFToken': csrfToken,
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({})
    });
    
    if (!res.ok) {
      throw new Error(`HTTP ${res.status}`);
    }
    
    const data = await res.json();
    console.log('Share link response:', data);
    
    // âœ… FIXED: Handle different response formats
    const shareUrl = data.share_url || data.link || (data.slug ? `${window.location.origin}/s/${data.slug}/` : null);
    
    if (!shareUrl) {
      throw new Error('No share URL in response');
    }

    const input = document.getElementById(`link-input-${fileId}`);
    input.value = shareUrl;
    input.style.display = 'block';
    input.select();
    
    await navigator.clipboard.writeText(shareUrl);
    btn.textContent = 'âœ… Copied!';
    
    alert(`âœ… Link copied to clipboard!\n${shareUrl}`);
    
  } catch (e) {
    console.error('Copy link failed:', e);
    btn.textContent = 'âŒ Failed';
    alert('âŒ Failed to generate link: ' + e.message);
  } finally {
    setTimeout(() => {
      btn.disabled = false;
      btn.textContent = originalText;
    }, 2000);
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ—‘ï¸ DELETE FILE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function deleteFile(id) {
  if (!confirm('Move this file to trash?')) return;
  try {
    const res = await fetch(`/files/delete/${id}/`, {
      method: 'POST',
      headers: { 'X-CSRFToken': csrfToken }
    });
    const data = await res.json();
    if (res.ok) {
      alert('âœ… File moved to trash');
      loadFiles();
      updateTrashCount();
    } else {
      alert('âŒ Delete failed: ' + (data.error || 'Permission denied'));
    }
  } catch (err) {
    alert('âŒ Delete error: ' + err.message);
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ—‘ï¸ LOAD TRASH FILES
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function loadTrashFiles() {
  console.log('ğŸ—‘ï¸ Loading trash files...');
  const trashList = document.getElementById('trash-list');
  
  if (!trashList) {
    console.error('âŒ Trash list element not found');
    return;
  }
  
  trashList.innerHTML = '<p class="loading">â³ Loading trash...</p>';
  
  try {
    const response = await fetch('/api/trash/', {
      method: 'GET',
      headers: { 
        'X-CSRFToken': csrfToken,
        'Content-Type': 'application/json'
      },
      credentials: 'same-origin'
    });
    
    if (!response.ok) {
      throw new Error(`HTTP error! status: ${response.status}`);
    }
    
    const data = await response.json();
    const files = Array.isArray(data) ? data : (data.files || []);
    
    document.getElementById('trash-count').textContent = files.length;
    
    if (files.length === 0) {
      trashList.innerHTML = '<p class="no-files">ğŸ—‘ï¸ Trash is empty</p>';
      return;
    }
    
    trashList.innerHTML = files.map(file => {
      const deletedDate = file.deleted_at ? new Date(file.deleted_at).toLocaleDateString('en-US', {
        year: 'numeric',
        month: 'short',
        day: 'numeric',
        hour: '2-digit',
        minute: '2-digit'
      }) : 'Unknown';
      
      const daysRemaining = file.days_remaining || 30;
      const daysClass = daysRemaining <= 7 ? 'warning' : '';
      
      return `
        <div class="file-item">
          <div class="file-info">
            <span class="file-name">ğŸ“„ ${escapeHtml(file.filename || file.original_name)}</span>
            <span class="file-size">${formatFileSize(file.size)}</span>
            <span class="delete-info">Deleted: ${deletedDate}</span>
            <span class="days-remaining ${daysClass}">
              â° ${daysRemaining} days until permanent deletion
            </span>
          </div>
          <button class="restore-btn" onclick="restoreFile(${file.id}, '${escapeHtml(file.filename || file.original_name)}')">
            â™»ï¸ Restore
          </button>
        </div>
      `;
    }).join('');
    
  } catch (error) {
    console.error('âŒ Error loading trash:', error);
    trashList.innerHTML = `<p class="no-files">âŒ Error loading trash: ${error.message}</p>`;
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// â™»ï¸ RESTORE FILE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function restoreFile(fileId, fileName) {
  if (!confirm(`Restore "${fileName}" from trash?`)) return;
  
  try {
    const response = await fetch(`/api/restore/${fileId}/`, {
      method: 'POST',
      headers: {
        'X-CSRFToken': csrfToken,
        'Content-Type': 'application/json'
      },
      credentials: 'same-origin'
    });
    
    const data = await response.json();
    
    if (response.ok && (data.status === 'success' || data.success)) {
      alert('âœ… File restored successfully!');
      loadTrashFiles();
      loadFiles();
    } else {
      alert('âŒ ' + (data.error || data.message || 'Failed to restore file'));
    }
  } catch (error) {
    console.error('âŒ Restore error:', error);
    alert('âŒ Failed to restore file: ' + error.message);
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ”§ UPDATE TRASH COUNT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function updateTrashCount() {
  try {
    const response = await fetch('/api/trash/', {
      headers: { 'X-CSRFToken': csrfToken }
    });
    const data = await response.json();
    const files = Array.isArray(data) ? data : (data.files || []);
    document.getElementById('trash-count').textContent = files.length;
  } catch (error) {
    console.error('Error updating trash count:', error);
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ”§ HELPER FUNCTIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function formatFileSize(bytes) {
  if (!bytes || bytes === 0) return '0 Bytes';
  const k = 1024;
  const sizes = ['Bytes', 'KB', 'MB', 'GB'];
  const i = Math.floor(Math.log(bytes) / Math.log(k));
  return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
}

function escapeHtml(text) {
  if (!text) return '';
  const div = document.createElement('div');
  div.textContent = text;
  return div.innerHTML;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ“‘ TAB SWITCHING
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
document.getElementById('files-tab').addEventListener('click', () => {
  document.getElementById('files-container').style.display = 'block';
  document.getElementById('trash-container').style.display = 'none';
  document.getElementById('files-tab').classList.add('active');
  document.getElementById('trash-tab').classList.remove('active');
  loadFiles();
});

document.getElementById('trash-tab').addEventListener('click', () => {
  document.getElementById('files-container').style.display = 'none';
  document.getElementById('trash-container').style.display = 'block';
  document.getElementById('files-tab').classList.remove('active');
  document.getElementById('trash-tab').classList.add('active');
  loadTrashFiles();
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸš€ INITIAL LOAD
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
document.addEventListener('DOMContentLoaded', function() {
  console.log('ğŸš€ Dashboard loaded');
  loadFiles();
  updateTrashCount();
});
</script>
</body>
</html>